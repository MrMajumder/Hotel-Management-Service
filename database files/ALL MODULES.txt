CREATE TABLE LOG_IN
(
LOGIN_EMAIL VARCHAR2(100) NOT NULL,
LOGIN_PASSWORD VARCHAR2(2000) NOT NULL,
LOGIN_ROLE VARCHAR2(100) NOT NULL,
CONSTRAINT LOG_IN_ID_PK PRIMARY KEY (LOGIN_EMAIL)
);


-----ACCOUNTHOLDER(USER)-----


CREATE TABLE ACCOUNT_HOLDER
(
USER_ID INTEGER NOT NULL,
LOGIN_EMAIL VARCHAR2(100),
FIRST_NAME VARCHAR2(100) NOT NULL, 
LAST_NAME VARCHAR2(100) NOT NULL,
HOUSE_NO VARCHAR2(10),  
ROAD_NO VARCHAR2(10),
CITY VARCHAR2(20),
COUNTRY VARCHAR2(20),
CONSTRAINT ACCOUNT_HOLDER_PK PRIMARY KEY (USER_ID),
CONSTRAINT LOGIN_FK FOREIGN KEY(LOGIN_EMAIL) REFERENCES LOG_IN ON DELETE CASCADE
);


------PHNUMBER-----

CREATE TABLE ACCOUNT_HOLDER_PHNUMBER
(
USER_ID INTEGER NOT NULL,
PH_NUMBER NUMBER NOT NULL,
CONSTRAINT PH_NUMBER_PK PRIMARY KEY (USER_ID, PH_NUMBER),
CONSTRAINT PH_NUMBER_FK FOREIGN KEY(USER_ID) REFERENCES ACCOUNT_HOLDER ON DELETE CASCADE
);



------CUSTOMER-----

CREATE TABLE CUSTOMER
(
USER_ID INTEGER NOT NULL,
ID_CARD_NO INTEGER NOT NULL,
PASSPORT_NO INTEGER,
CREDIT_CARD_NO INTEGER,
CONSTRAINT CUSTOMER_PK PRIMARY KEY (USER_ID),
CONSTRAINT CUSTOMER_FK FOREIGN KEY(USER_ID) REFERENCES ACCOUNT_HOLDER ON DELETE CASCADE
);

-----EMPLOYEE-----


CREATE TABLE EMPLOYEE
(
USER_ID INTEGER NOT NULL, 
MANAGER_ID INTEGER ,
POSITION VARCHAR2(30) NOT NULL,
WORK_DESCRIPTION VARCHAR2(1000) NOT NULL,
PERMISSION VARCHAR2(10) NOT NULL,
BASE_SALARY INTEGER NOT NULL,
ATTENDANCE VARCHAR2(10) ,
AVAILABILITY INTEGER DEFAULT 0,
CONSTRAINT EMPLOYEE_PK PRIMARY KEY (USER_ID),
CONSTRAINT EMPLOYEE_FK FOREIGN KEY(USER_ID) REFERENCES ACCOUNT_HOLDER ON DELETE CASCADE,
CONSTRAINT MANAGER_FK FOREIGN KEY(MANAGER_ID) REFERENCES EMPLOYEE ON DELETE CASCADE);


----RESERVATION-----

CREATE TABLE RESERVATION
(
RESERVATION_ID NUMBER CONSTRAINT RES_PK PRIMARY KEY,
GUEST_NO NUMBER,
ARRIVAL_DATE DATE DEFAULT SYSDATE,
DEPARTURE_DATE DATE,
RESERVATION_ACTIVE NUMBER DEFAULT 0,
USER_ID NUMBER NOT NULL,
CONSTRAINT RES_FK FOREIGN KEY(USER_ID) REFERENCES CUSTOMER(USER_ID) ON DELETE CASCADE
);


CREATE TABLE BOOKED_ROOMS
(
RESERVATION_ID INTEGER NOT NULL,
ROOM_ID NUMBER NOT NULL,
ARRIVAL_DATE DATE DEFAULT SYSDATE,
DEPARTURE_DATE DATE,
CONSTRAINT BOOKED_ROOMS_PK PRIMARY KEY (RESERVATION_ID, ROOM_ID),
CONSTRAINT BOOKED_ROOMS_FK FOREIGN KEY(RESERVATION_ID) REFERENCES RESERVATION ON DELETE CASCADE
);


-----ROOM-----


CREATE TABLE ROOM
(
ROOM_ID NUMBER CONSTRAINT RM_PK PRIMARY KEY,
BUILDING NUMBER NOT NULL,
FLOOR NUMBER NOT NULL,
CAPACITY NUMBER NOT NULL,
AC NUMBER,
BED_NO NUMBER,
RENT NUMBER CHECK(RENT >= 0),
RESERVATION_ID NUMBER,
-- CONSTRAINT RM_FK FOREIGN KEY(RESERVATION_ID) REFERENCES RESERVATION(RESERVATION_ID),
ROOM_TYPE VARCHAR2(100) NOT NULL
);

-----SERVICES-----


CREATE TABLE SERVICES
(
SERVICE_ID NUMBER CONSTRAINT SRV_PK PRIMARY KEY,
NAME VARCHAR2(128) NOT NULL,
COST NUMBER NOT NULL CHECK(COST >= 0),
DESCRIPTION VARCHAR2(256),
USER_ID NUMBER NOT NULL,
CONSTRAINT SRV_FK FOREIGN KEY(USER_ID) REFERENCES EMPLOYEE(USER_ID) ON DELETE CASCADE
);

-----BILL-----

CREATE TABLE BILL
(
BILL_ID INTEGER NOT NULL, 
COST NUMBER NOT NULL CHECK(COST >= 0), 
BILL_DATE DATE,
VAT_PERCENTAGE NUMBER DEFAULT 0,
CONSTRAINT BILL_PK PRIMARY KEY (BILL_ID)
);

-----HOTELBILL----- 


CREATE TABLE HOTEL_BILL
(
BILL_ID INTEGER NOT NULL,
RESERVATION_ID INTEGER NOT NULL,
INCOME_TYPE INTEGER DEFAULT 0,
CONSTRAINT HOTELBILL_PK PRIMARY KEY (BILL_ID),
CONSTRAINT HOTELBILL_FK FOREIGN KEY (BILL_ID) REFERENCES BILL(BILL_ID) ON DELETE CASCADE,
CONSTRAINT HOTELBILL_RESERV_FK FOREIGN KEY (RESERVATION_ID) REFERENCES RESERVATION(RESERVATION_ID) ON DELETE CASCADE
);

------EXPENSES-----
-- DROP TABLE ROOM_HB_SERV_RECEIVES;
-- DROP TABLE HOTEL_BILL;
CREATE TABLE EXPENSES
(
BILL_ID INTEGER NOT NULL,
USER_ID INTEGER NOT NULL,
EXPENSE_TYPE VARCHAR2(20) NOT NULL,
DESCRIPTION VARCHAR2(200) NOT NULL,
CONSTRAINT EXPENSES_PK PRIMARY KEY (BILL_ID),
CONSTRAINT EXPENSES_FK1 FOREIGN KEY (BILL_ID) REFERENCES BILL ON DELETE CASCADE,
CONSTRAINT EXPENSES_FK2 FOREIGN KEY (USER_ID) REFERENCES EMPLOYEE ON DELETE CASCADE
);

-- ------RESERVATION_HOTELBILL-----
-- 
-- CREATE TABLE RESERVATION_HOTELBILL
-- (
-- BILL_ID INTEGER NOT NULL,
-- RESERVATION_ID NUMBER NOT NULL,
-- CONSTRAINT RES_HB_PK PRIMARY KEY (BILL_ID, RESERVATION_ID),
-- CONSTRAINT RES_HB_FK1 FOREIGN KEY (BILL_ID) REFERENCES HOTEL_BILL ON DELETE CASCADE,
-- CONSTRAINT RES_HB_FK2 FOREIGN KEY (RESERVATION_ID) REFERENCES RESERVATION ON DELETE CASCADE
-- );
-- 
------ROOM_SERVICES_HOTELBILL-----

CREATE TABLE ROOM_HB_SERV_RECEIVES
(
SERVICE_ID NUMBER CONSTRAINT RCV_PK PRIMARY KEY,
ROOM_ID NUMBER NOT NULL,
BILL_ID INTEGER NOT NULL,
SERVICE_ACTIVE NUMBER DEFAULT (0),
CONSTRAINT RCV_FK1 FOREIGN KEY(SERVICE_ID) REFERENCES SERVICES(SERVICE_ID) ON DELETE CASCADE,
CONSTRAINT RCV_FK2 FOREIGN KEY(ROOM_ID) REFERENCES ROOM(ROOM_ID) ON DELETE CASCADE,
CONSTRAINT RCV_FK3 FOREIGN KEY(BILL_ID) REFERENCES HOTEL_BILL ON DELETE CASCADE
);

-----WORK HISTORY-------

CREATE TABLE WORK_HISTORY
(
USER_ID INTEGER NOT NULL,
ATTEND_DATE DATE DEFAULT SYSDATE,
CONSTRAINT WH_PK PRIMARY KEY (USER_ID, ATTEND_DATE),
CONSTRAINT WH_FK FOREIGN KEY (USER_ID) REFERENCES EMPLOYEE(USER_ID)
);



CREATE TABLE COMPLAIN
(
COMP_ID NUMBER,
USER_ID INTEGER NOT NULL,
COMP VARCHAR2(2000) NOT NULL,
COMPTYPE VARCHAR2(100) NOT NULL,
CDATE DATE DEFAULT SYSDATE,
CHECKK NUMBER,
CONSTRAINT COMPLAIN_PK PRIMARY KEY (COMP_ID)
);


